"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const fs = require("fs");
const path = require("path");
const constants_1 = require("./constants");
function getSysRemotePath(role) {
    let p = path.join(__dirname, '/../common/remote/', role);
    return fs.existsSync(p) ? p : null;
}
exports.getSysRemotePath = getSysRemotePath;
function getUserRemotePath(appBase, serverType) {
    let p = path.join(appBase, '/app/servers/', serverType, constants_1.DIR.REMOTE);
    return fs.existsSync(p) ? p : null;
}
exports.getUserRemotePath = getUserRemotePath;
function getCronPath(appBase, serverType) {
    let p = path.join(appBase, '/app/servers/', serverType, constants_1.DIR.CRON);
    return fs.existsSync(p) ? p : null;
}
exports.getCronPath = getCronPath;
function listUserRemoteDir(appBase) {
    let base = path.join(appBase, '/app/servers/');
    let files = fs.readdirSync(base);
    return files.filter((fn) => {
        if (fn.charAt(0) === '.') {
            return false;
        }
        return fs.statSync(path.join(base, fn)).isDirectory();
    });
}
exports.listUserRemoteDir = listUserRemoteDir;
function remotePathRecord(namespace, serverType, path) {
    return { namespace: namespace, serverType: serverType, path: path };
}
exports.remotePathRecord = remotePathRecord;
function getHandlerPath(appBase, serverType) {
    let p = path.join(appBase, '/app/servers/', serverType, constants_1.DIR.HANDLER);
    return fs.existsSync(p) ? p : null;
}
exports.getHandlerPath = getHandlerPath;
function getScriptPath(appBase) {
    return path.join(appBase, constants_1.DIR.SCRIPT);
}
exports.getScriptPath = getScriptPath;
function getLogPath(appBase) {
    return path.join(appBase, constants_1.DIR.LOG);
}
exports.getLogPath = getLogPath;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGF0aFV0aWwuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJwYXRoVXRpbC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLHlCQUEwQjtBQUMxQiw2QkFBOEI7QUFDOUIsMkNBQWtDO0FBRWxDLDBCQUFpQyxJQUFXO0lBQzFDLElBQUksQ0FBQyxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsU0FBUyxFQUFFLG9CQUFvQixFQUFFLElBQUksQ0FBQyxDQUFDO0lBQ3pELE1BQU0sQ0FBQyxFQUFFLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQztBQUNyQyxDQUFDO0FBSEQsNENBR0M7QUFFRCwyQkFBa0MsT0FBYyxFQUFFLFVBQWlCO0lBQ2pFLElBQUksQ0FBQyxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFLGVBQWUsRUFBRSxVQUFVLEVBQUUsZUFBRyxDQUFDLE1BQU0sQ0FBQyxDQUFDO0lBQ3BFLE1BQU0sQ0FBQyxFQUFFLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQztBQUNyQyxDQUFDO0FBSEQsOENBR0M7QUFFRCxxQkFBNEIsT0FBYyxFQUFFLFVBQWlCO0lBQzNELElBQUksQ0FBQyxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFLGVBQWUsRUFBRSxVQUFVLEVBQUUsZUFBRyxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ2xFLE1BQU0sQ0FBQyxFQUFFLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQztBQUNyQyxDQUFDO0FBSEQsa0NBR0M7QUFFRCwyQkFBa0MsT0FBYztJQUM5QyxJQUFJLElBQUksR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxlQUFlLENBQUMsQ0FBQztJQUMvQyxJQUFJLEtBQUssR0FBRyxFQUFFLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ2pDLE1BQU0sQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLENBQUMsRUFBRSxFQUFDLEVBQUU7UUFDeEIsRUFBRSxDQUFBLENBQUMsRUFBRSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsS0FBSyxHQUFHLENBQUMsQ0FBQyxDQUFDO1lBQ3hCLE1BQU0sQ0FBQyxLQUFLLENBQUM7UUFDZixDQUFDO1FBRUQsTUFBTSxDQUFDLEVBQUUsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQztJQUN4RCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUM7QUFWRCw4Q0FVQztBQUVELDBCQUFpQyxTQUFnQixFQUFFLFVBQWlCLEVBQUUsSUFBVztJQUMvRSxNQUFNLENBQUMsRUFBQyxTQUFTLEVBQUUsU0FBUyxFQUFFLFVBQVUsRUFBRSxVQUFVLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBQyxDQUFDO0FBQ3BFLENBQUM7QUFGRCw0Q0FFQztBQUVELHdCQUErQixPQUFjLEVBQUUsVUFBaUI7SUFDOUQsSUFBSSxDQUFDLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsZUFBZSxFQUFFLFVBQVUsRUFBRSxlQUFHLENBQUMsT0FBTyxDQUFDLENBQUM7SUFDckUsTUFBTSxDQUFDLEVBQUUsQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDO0FBQ3JDLENBQUM7QUFIRCx3Q0FHQztBQUVELHVCQUE4QixPQUFjO0lBQzFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxlQUFHLENBQUMsTUFBTSxDQUFDLENBQUM7QUFDeEMsQ0FBQztBQUZELHNDQUVDO0FBRUQsb0JBQTJCLE9BQWM7SUFDdkMsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFLGVBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQztBQUNyQyxDQUFDO0FBRkQsZ0NBRUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgZnMgPSByZXF1aXJlKCdmcycpO1xyXG5pbXBvcnQgcGF0aCA9IHJlcXVpcmUoJ3BhdGgnKTtcclxuaW1wb3J0IHsgRElSIH0gZnJvbSAnLi9jb25zdGFudHMnO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdldFN5c1JlbW90ZVBhdGgocm9sZTpzdHJpbmcpIHtcclxuICBsZXQgcCA9IHBhdGguam9pbihfX2Rpcm5hbWUsICcvLi4vY29tbW9uL3JlbW90ZS8nLCByb2xlKTtcclxuICByZXR1cm4gZnMuZXhpc3RzU3luYyhwKSA/IHAgOiBudWxsO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0VXNlclJlbW90ZVBhdGgoYXBwQmFzZTpzdHJpbmcsIHNlcnZlclR5cGU6c3RyaW5nKSB7XHJcbiAgbGV0IHAgPSBwYXRoLmpvaW4oYXBwQmFzZSwgJy9hcHAvc2VydmVycy8nLCBzZXJ2ZXJUeXBlLCBESVIuUkVNT1RFKTtcclxuICByZXR1cm4gZnMuZXhpc3RzU3luYyhwKSA/IHAgOiBudWxsO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0Q3JvblBhdGgoYXBwQmFzZTpzdHJpbmcsIHNlcnZlclR5cGU6c3RyaW5nKSB7XHJcbiAgbGV0IHAgPSBwYXRoLmpvaW4oYXBwQmFzZSwgJy9hcHAvc2VydmVycy8nLCBzZXJ2ZXJUeXBlLCBESVIuQ1JPTik7XHJcbiAgcmV0dXJuIGZzLmV4aXN0c1N5bmMocCkgPyBwIDogbnVsbDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGxpc3RVc2VyUmVtb3RlRGlyKGFwcEJhc2U6c3RyaW5nKSB7XHJcbiAgbGV0IGJhc2UgPSBwYXRoLmpvaW4oYXBwQmFzZSwgJy9hcHAvc2VydmVycy8nKTtcclxuICBsZXQgZmlsZXMgPSBmcy5yZWFkZGlyU3luYyhiYXNlKTtcclxuICByZXR1cm4gZmlsZXMuZmlsdGVyKChmbik9PiB7XHJcbiAgICBpZihmbi5jaGFyQXQoMCkgPT09ICcuJykge1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGZzLnN0YXRTeW5jKHBhdGguam9pbihiYXNlLCBmbikpLmlzRGlyZWN0b3J5KCk7XHJcbiAgfSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiByZW1vdGVQYXRoUmVjb3JkKG5hbWVzcGFjZTpzdHJpbmcsIHNlcnZlclR5cGU6c3RyaW5nLCBwYXRoOnN0cmluZykge1xyXG4gIHJldHVybiB7bmFtZXNwYWNlOiBuYW1lc3BhY2UsIHNlcnZlclR5cGU6IHNlcnZlclR5cGUsIHBhdGg6IHBhdGh9O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0SGFuZGxlclBhdGgoYXBwQmFzZTpzdHJpbmcsIHNlcnZlclR5cGU6c3RyaW5nKSB7XHJcbiAgbGV0IHAgPSBwYXRoLmpvaW4oYXBwQmFzZSwgJy9hcHAvc2VydmVycy8nLCBzZXJ2ZXJUeXBlLCBESVIuSEFORExFUik7XHJcbiAgcmV0dXJuIGZzLmV4aXN0c1N5bmMocCkgPyBwIDogbnVsbDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdldFNjcmlwdFBhdGgoYXBwQmFzZTpzdHJpbmcpIHtcclxuICByZXR1cm4gcGF0aC5qb2luKGFwcEJhc2UsIERJUi5TQ1JJUFQpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0TG9nUGF0aChhcHBCYXNlOnN0cmluZykge1xyXG4gIHJldHVybiBwYXRoLmpvaW4oYXBwQmFzZSwgRElSLkxPRyk7XHJcbn1cclxuIl19