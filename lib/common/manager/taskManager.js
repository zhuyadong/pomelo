"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const sequeue = require('seq-queue');
const queues = {};
exports.timeout = 3000;
function addTask(key, fn, ontimeout, timeout) {
    var queue = queues[key];
    if (!queue) {
        queue = sequeue.createQueue(timeout);
        queues[key] = queue;
    }
    return queue.push(fn, ontimeout, timeout);
}
exports.addTask = addTask;
;
function closeQueue(key, force = false) {
    if (!queues[key]) {
        // ignore illeagle key
        return;
    }
    queues[key].close(force);
    delete queues[key];
}
exports.closeQueue = closeQueue;
;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGFza01hbmFnZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJ0YXNrTWFuYWdlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLE1BQU0sT0FBTyxHQUFHLE9BQU8sQ0FBQyxXQUFXLENBQUMsQ0FBQztBQUNyQyxNQUFNLE1BQU0sR0FBc0IsRUFBRSxDQUFDO0FBRXhCLFFBQUEsT0FBTyxHQUFHLElBQUksQ0FBQztBQUU1QixpQkFBd0IsR0FBVSxFQUFFLEVBQVcsRUFBRSxTQUFtQixFQUFFLE9BQWU7SUFDbkYsSUFBSSxLQUFLLEdBQUcsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQ3hCLEVBQUUsQ0FBQSxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQztRQUNWLEtBQUssR0FBRyxPQUFPLENBQUMsV0FBVyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQ3JDLE1BQU0sQ0FBQyxHQUFHLENBQUMsR0FBRyxLQUFLLENBQUM7SUFDdEIsQ0FBQztJQUVELE1BQU0sQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLEVBQUUsRUFBRSxTQUFTLEVBQUUsT0FBTyxDQUFDLENBQUM7QUFDNUMsQ0FBQztBQVJELDBCQVFDO0FBQUEsQ0FBQztBQUVGLG9CQUEyQixHQUFVLEVBQUUsUUFBZ0IsS0FBSztJQUMxRCxFQUFFLENBQUEsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDaEIsc0JBQXNCO1FBQ3RCLE1BQU0sQ0FBQztJQUNULENBQUM7SUFFRCxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQ3pCLE9BQU8sTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDO0FBQ3JCLENBQUM7QUFSRCxnQ0FRQztBQUFBLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBzZXF1ZXVlID0gcmVxdWlyZSgnc2VxLXF1ZXVlJyk7XHJcbmNvbnN0IHF1ZXVlczp7W2lkeDpzdHJpbmddOmFueX0gPSB7fTtcclxuXHJcbmV4cG9ydCBjb25zdCB0aW1lb3V0ID0gMzAwMDtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBhZGRUYXNrKGtleTpzdHJpbmcsIGZuOkZ1bmN0aW9uLCBvbnRpbWVvdXQ/OkZ1bmN0aW9uLCB0aW1lb3V0PzpudW1iZXIpIHtcclxuICB2YXIgcXVldWUgPSBxdWV1ZXNba2V5XTtcclxuICBpZighcXVldWUpIHtcclxuICAgIHF1ZXVlID0gc2VxdWV1ZS5jcmVhdGVRdWV1ZSh0aW1lb3V0KTtcclxuICAgIHF1ZXVlc1trZXldID0gcXVldWU7XHJcbiAgfVxyXG5cclxuICByZXR1cm4gcXVldWUucHVzaChmbiwgb250aW1lb3V0LCB0aW1lb3V0KTtcclxufTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjbG9zZVF1ZXVlKGtleTpudW1iZXIsIGZvcmNlOmJvb2xlYW4gPSBmYWxzZSkge1xyXG4gIGlmKCFxdWV1ZXNba2V5XSkge1xyXG4gICAgLy8gaWdub3JlIGlsbGVhZ2xlIGtleVxyXG4gICAgcmV0dXJuO1xyXG4gIH1cclxuXHJcbiAgcXVldWVzW2tleV0uY2xvc2UoZm9yY2UpO1xyXG4gIGRlbGV0ZSBxdWV1ZXNba2V5XTtcclxufTtcclxuXHJcbiJdfQ==